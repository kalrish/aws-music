{
	"variables": {
		"aws_access_key": "{{ env `AWS_ACCESS_KEY_ID` }}",
		"aws_secret_key": "{{ env `AWS_SECRET_ACCESS_KEY` }}",
		"aws_token": "{{ env `AWS_SESSION_TOKEN` }}",
		"instance_type": "t2.micro",
		"region": "{{ env `AWS_REGION` }}",
		"security_group_ids": "{{ env `INSTANCE_SECURITY_GROUP` }}",
		"ssh_user": "admin"
	},
	"provisioners": [
		{
			"type": "shell",
			"inline": [
				"apt-get -qq update && apt-get -qq install python-minimal"
			]
		},
		{
			"type": "ansible",
			"playbook_file": "playbook.yaml",
			"user": "{{ user `ssh_user` }}"
		}
	],
	"builders": [
		{
			"access_key": "{{ user `aws_access_key` }}",
			"ami_virtualization_type": "hvm",
			"associate_public_ip_address": false,
			"instance_type": "{{ user `instance_type` }}",
			"region": "{{ user `region` }}",
			"secret_key": "{{ user `aws_secret_key` }}",
			"security_group_ids": "{{ user `security_group_ids` }}",
			"source_ami": "ami-",
			"ssh_interface": "private_ip",
			"ssh_keypair_name": "music",
			"ssh_private_key_file": "ssh.key",
			"ssh_username": "{{ user `ssh_user` }}",
			"subnet_id": "",
			"token": "{{ user `aws_token` }}",
			"type": "amazon-ebsvolume",
			"vpc_id": ""
		}
	]
}
